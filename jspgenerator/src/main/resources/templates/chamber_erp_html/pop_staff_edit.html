<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>员工</title>
    <meta name="description" content="">
    <meta name="author" content="templatemo">
    <link href="../chamber_erp_css/font-awesome.css?ver=1.0" rel="stylesheet" type="text/css" />
    <link href="../chamber_erp_css/bootstrap.min.css?ver=1.0" rel="stylesheet">
    <link href="../chamber_erp_css/templatemo_style.css?ver=1.0" rel="stylesheet">
    <link href="../chamber_erp_css/slidernav.css?ver=1.0" rel="stylesheet">
    <link href="../chamber_erp_css/ob_style.css?ver=1.0" rel="stylesheet">
    <link href="../chamber_erp_css/select2.css?ver=1.0" rel="stylesheet">
    
    <link href="../chamber_css/bs_div.css?ver=1.0" rel="stylesheet">  
    <link href="../chamber_css/bs_a.css?ver=1.0" rel="stylesheet">
    <link href="../chamber_css/menu_style.css?ver=1.0" rel="stylesheet">
	<link href="../chamber_css/chat.css?ver=1.0" rel="stylesheet">
    
    <link href="../js/alertify/alertify.core.css" rel="stylesheet" type="text/css"/>
    <link href="../js/alertify/alertify.bootstrap.css" rel="stylesheet" type="text/css"/>
    
    <script src="../js/jquery-1.8.3.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/moment.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/alertify/alertify.js" type="text/javascript" charset="utf-8"></script>
    
    <script src="../js/ajax_janus.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/column_janus_mobile.js" type="text/javascript" charset="utf-8"></script>
    <script src="../widgets/lhgdialog/lhgdialog.js?skin=iblue" type="text/javascript" charset="utf-8"></script>
    <script src="../js/janus_dialog.js" type="text/javascript" charset="utf-8"></script>
    <script src="../My97DatePicker/WdatePicker.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/select2.js" type="text/javascript" charset="utf-8"></script>
    
    <!--#
    <JREMOVE>
    <link rel="stylesheet" type="text/css" href="../ckeditor/skins/v2/editor.css">
    <script type="text/javascript" language="javascript" src="../ckeditor/ckeditor.js"></script>
    <script type="text/javascript" src="../ckeditor/config.js"></script>
    <script type="text/javascript" src="../ckeditor/skins/v2/skin.js"></script>
    <script type="text/javascript" src="../ckeditor/lang/zh-cn.js"></script>
    <script type="text/javascript" src="../ckeditor/plugins/lineheight/plugin.js"></script>
    <script type="text/javascript" src="../ckeditor/plugins/jwplayer/plugin.js"></script>
    <script type="text/javascript" src="../ckeditor/plugins/video/plugin.js"></script>
    <script type="text/javascript" src="../ckeditor/plugins/audio/plugin.js"></script>
    <script type="text/javascript" src="../ckeditor/plugins/jwplayer/lang/zh-cn.js"></script>
    <script type="text/javascript" src="../ckeditor/plugins/jwplayer/lang/zh-cn.js"></script>
    <script type="text/javascript" src="../ckeditor/plugins/styles/styles/default.js"></script>
    </JREMOVE>
    #-->
    <!--#
    <MACRO>
      Jsp.includejsp("/chamber_jsp/chamber_const_html/erp_const_define.jsp");
      Jsp.includejsp("/chamber_jsp/chamber_module_html/erp_login_staff_info.jsp");
      Jsp.result("_loginStaff","_roleFuncMap");
    </MACRO>
    #-->
    <script>
    /*# 
      <c:if test="${_loginStaff eq null || _loginStaff.ext.cstaffNo eq null || _loginStaff.ext.cstaffNo eq ''}">
        setTimeout(function(){
          parent.parent.parent.window.location.href = "<%=basePath%>bs_ajaxIndex!chamber!chamber_erp_html!login.do";
        },200);
      </c:if>
    #*/
    </script> 
  </head>

<!--#
<east:service beanName="pmsService.pmsDaoImpl.daoBsDataDic" methodName="getNewsDicClassNameChildrenEx"  id="dicUserStatus">
  <east:para name="className" value="dicUserStatus" type="String" />
</east:service>
<east:service beanName="pmsService.pmsDaoImpl.daoBsDataDic" methodName="getNewsDicClassNameChildrenEx"  id="dicSysRole">
  <east:para name="className" value="dicSysRole" type="String" />
</east:service>
#-->

<!--#
<s:if test="${requestEx.id ne 0}">
  <east:service beanName="pmsService.pmsDaoImpl.daoBsNewsInfo" methodName="getOneByIdAlwaysWithClass"  id="_staff">
    <east:para name="tnewsid" value="${requestEx.id}" type="String" />
    <east:para name="className" value="colStaff" type="String" />
  </east:service>
</s:if>
<s:else>
  <east:service beanName="pmsService.pmsDaoImpl.daoBsNewsInfo" methodName="createBeanExByClassName" id="_staff">       
    <east:para name="className" value="colStaff" type="String" />
  </east:service>
</s:else>
#-->
<!--#
<s:if test="${requestEx.id ne 0}">
  <east:service beanName="eastUtilService" methodName="setValue"  id="defaultStatus">
    <east:para name="_value" value="${_staff.ext.cstatus}" type="Object" />
  </east:service>
</s:if>
<s:else>
  <east:service beanName="eastUtilService" methodName="setValue"  id="defaultStatus">
    <east:para name="_value" value="1" type="Object" />
  </east:service>
</s:else>
#-->

  <body>
    <div class="" id="" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog">
        <form name="frmSubmit" id="frmSubmit"  enctype="multipart/form-data" method="post" action="<%=basePath%>admin/east_ajax_do_add_news_no_pass.do" autocomplete="off">
          <input type="hidden" name="id" value="${requestEx.id}" />
          
          <div class="">
            <div class="modal-header">
              <h4 class="modal-title" id="myModalLabel">员工</h4>
            </div>
            <div class="modal-body">
              <div>
                <label for="crealName">
                  <p><b>*</b>姓名：</p>
                </label>
                <input type="text" id="crealName" name="crealName" value="${_staff.ext.crealName}" />
              </div>
              <div>
                <label for="cphone">
                  <p><b>*</b>手机号：</p>
                </label>
                <input type="text" id="cphone" name="cphone" value="${_staff.ext.cphone}" />
              </div>
              <div>
                <label for="cpassword">
                  <p><b>*</b>登陆密码：</p>
                </label>
                <input type="password" id="cpassword" name="cpassword" value="${_staff.ext.cpassword}" />
              </div>
              <div>
                <label for="crole">
                  <p><b>*</b>员工角色：</p>
                </label>
                <select id="crole" name="crole">
                  <option value="">请选择...</option>
                  <c:forEach items="${dicSysRole}" var="_oneDic" varStatus="_statusDic">
                    <s:if test="${_oneDic.dicVal eq _staff.ext.crole}">
                      <option value="${_oneDic.dicVal}" selected="selected">${_oneDic.dicName}</option>
                    </s:if>
                    <s:else>
                      <option value="${_oneDic.dicVal}">${_oneDic.dicName}</option>
                    </s:else>
                  </c:forEach>
                </select>
              </div>
              <div>
                <label for="cstatus">
                  <p><b>*</b>状态：</p>
                </label>
                <select id="cstatus" name="cstatus">
                  <c:forEach items="${dicUserStatus}" var="_oneDic" varStatus="_statusDic">
                    <s:if test="${_oneDic.dicVal eq defaultStatus}">
                      <option value="${_oneDic.dicVal}" selected="selected">${_oneDic.dicName}</option>
                    </s:if>
                    <s:else>
                      <option value="${_oneDic.dicVal}">${_oneDic.dicName}</option>
                    </s:else>
                  </c:forEach>
                </select>
              </div>
            

              
              <!--#
              <JREMOVE>
              <div>
                <label for="cimage">
                  <p><b>*</b>封面图：</p>
                </label>
                <button type="button" id="btnUpload">上传图片</button>
                <input type="hidden" id="cimage" value="${_staff.ext.cimage}" name="cimage" />
                <s:if test="${_staff.ext.cimage ne null && _staff.ext.cimage ne ''}">
                  <a id="displayImage" style="color:#337ab7" href="./${_staff.ext.cimage}" target="_blank">查看图片</a>
                </s:if>
                <s:else>
                  <a id="displayImage" style="display:none;color:#337ab7" target="_blank">查看图片</a>
                </s:else>
              </div>
              <east:service beanName="eastUtilService" methodName="ProxyCaller.objCall2NV"  id="_contentDisp">
                <east:para name="_class" value="com.east.regex.HtmlUtil" type="String" /> 
                <east:para name="_fun" value="fetchBody" type="String" />  
                <east:para name="_html" value="${_staff.ext.ccontent}" type="String" />  
              </east:service>
              <div>
                <label for="contentDisp">
                  <p><b>*</b>内容：</p>
                </label>
                <textarea id="contentDisp" rows="8" cols="54" placeholder="内容" class="text_border80" style="width:24em!important;margin-left: 10em;min-height: 300px;">${_contentDisp}</textarea>
                <input type="hidden" id="ccontent" name="ccontent" />
              </div>
              </JREMOVE>
              #-->
              
            </div><!--modal-body-->

            <div class="modal-footer">
              <button type="button" class="btn btn-primary" style="margin-right: 45%;" id="btnSave">保存</button>
            </div>
          </div>
        </form>
      </div>
    </div>
    <script>
      $(function(){
        $('#btnSave').bind("click", function() {
          var crealName = $("#crealName").val();
          if(crealName == '') {
            alertify.alert("请填写姓名。");
            return false;
          }
          var cphone = $("#cphone").val();
          if(!__JisMobile(cphone)) {
            alertify.alert("请填写正确的手机号。");
            return false;
          }
          var cpassword = $("#cpassword").val();
          if (/^(?=.*[0-9])(?=.*[A-Z])(?=.*[a-z]).{8,}$/.test(cpassword)){
          } else {
             alertify.alert("密码必须由大小写字母和数组组合，不能少于8位。");
             return false;
          }
          
          var crole = $("#crole").val();
          if(crole == '') {
            alertify.alert("请选择员工角色。");
            return false;
          } else {
            if (crole == '9' && '${_loginStaff.ext.crole}' != '9') {
              alertify.alert("只有系统管理员可以创建、编辑其他系统管理员。");
              return false;
            }
          }
          var _url_para = $("#frmSubmit").serialize(),
            _url = "<%=basePath%>bs_ajaxIndex!chamber!chamber_controls_html!erp_staff_save.do";
          $AjaxPostASyn(_url, _url_para,
            function(_resp) {
              var jsonResp = JSON.parse(_resp);
              if(jsonResp.state == 'success') {
                alertify.alert("操作成功!", function(_msg) {
                  __JDialogCallbackAndClose();
                });
              } else {
                alertify.alert(jsonResp.msg);
              }
            },
            function(_resp) {});
          return false;
        });// end btnSave
      })
    </script>


  </body>
</html>